window.piano = new Howl({
    src: ['piano.mp3'],
    volume: 1,
    sprite: {
        "A#1": [0, 2009.9773242630388],
        "A#2": [2009.9773242630388, 2009.9773242630388],
        "A#3": [4019.9546485260776, 2027.3922902494332],
        "A#4": [6047.34693877551, 2018.6848072562364],
        "A#5": [8066.031746031747, 2015.78231292517],
        "A#6": [10081.814058956918, 2012.8798185941043],
        "A#7": [12094.69387755102, 2009.9773242630388],
        "A#8": [14104.67120181406, 2009.977324263037],
        "Ab1": [16114.648526077097, 2009.9773242630406],
        "Ab2": [18124.625850340137, 2024.4897959183668],
        "Ab3": [20149.115646258506, 2009.977324263037],
        "Ab4": [22159.092970521542, 2009.9773242630406],
        "Ab5": [24169.070294784582, 2012.8798185941043],
        "Ab6": [26181.950113378687, 2012.8798185941043],
        "Ab7": [28194.829931972792, 2009.9773242630406],
        "Ab8": [30204.807256235832, 2007.0748299319732],
        "An1": [32211.882086167803, 2009.9773242630406],
        "An2": [34221.85941043084, 2009.9773242630406],
        "An3": [36231.83673469388, 2007.0748299319732],
        "An4": [38238.91156462586, 2018.6848072562357],
        "An5": [40257.59637188209, 2012.879818594108],
        "An6": [42270.476190476205, 2015.7823129251683],
        "An7": [44286.25850340137, 2009.9773242630406],
        "An8": [46296.23582766441, 2009.9773242630406],
        "B#1": [48306.21315192745, 2009.9773242630406],
        "B#2": [50316.190476190495, 2009.9773242630406],
        "B#3": [52326.167800453535, 2027.3922902494305],
        "B#4": [54353.560090702966, 2015.7823129251683],
        "B#5": [56369.34240362813, 2015.7823129251683],
        "B#6": [58385.1247165533, 2012.879818594108],
        "B#7": [60398.00453514741, 2009.9773242630406],
        "B#8": [62407.98185941045, 2009.9773242630406],
        "Bb1": [64417.95918367349, 2009.9773242630336],
        "Bb2": [66427.93650793652, 2009.9773242630336],
        "Bb3": [68437.91383219956, 2027.3922902494378],
        "Bb4": [70465.306122449, 2018.6848072562357],
        "Bb5": [72483.99092970522, 2015.7823129251683],
        "Bb6": [74499.7732426304, 2012.879818594101],
        "Bb7": [76512.6530612245, 2009.9773242630336],
        "Bb8": [78522.63038548753, 2009.9773242630336],
        "Bn1": [80532.60770975056, 2009.9773242630336],
        "Bn2": [82542.5850340136, 2009.9773242630336],
        "Bn3": [84552.56235827663, 2027.3922902494378],
        "Bn4": [86579.95464852607, 2015.7823129251683],
        "Bn5": [88595.73696145124, 2015.7823129251683],
        "Bn6": [90611.5192743764, 2012.879818594101],
        "Bn7": [92624.3990929705, 2009.9773242630336],
        "Bn8": [94634.37641723354, 2009.9773242630336],
        "C#1": [96644.35374149657, 2009.9773242630336],
        "C#2": [98654.3310657596, 2009.9773242630336],
        "C#3": [100664.30839002263, 2009.9773242630336],
        "C#4": [102674.28571428567, 2024.4897959183704],
        "C#5": [104698.77551020404, 2012.879818594101],
        "C#6": [106711.65532879815, 2012.879818594101],
        "C#7": [108724.53514739225, 2012.879818594101],
        "C#8": [110737.41496598635, 2009.9773242630336],
        "Cb2": [112747.39229024938, 2009.9773242630336],
        "Cb3": [114757.36961451241, 2009.9773242630336],
        "Cb4": [116767.34693877544, 2027.3922902494378],
        "Cb5": [118794.73922902488, 2015.7823129251683],
        "Cb6": [120810.52154195005, 2015.7823129251683],
        "Cb7": [122826.30385487522, 2012.879818594101],
        "Cb8": [124839.18367346932, 2009.9773242630336],
        "Cb9": [126849.16099773235, 2009.9773242630476],
        "Cn1": [128859.1383219954, 2009.9773242630476],
        "Cn2": [130869.11564625845, 2009.9773242630476],
        "Cn3": [132879.0929705215, 2009.9773242630476],
        "Cn4": [134889.07029478456, 2027.3922902494235],
        "Cn5": [136916.46258503397, 2015.7823129251824],
        "Cn6": [138932.24489795914, 2015.7823129251824],
        "Cn7": [140948.02721088432, 2012.879818594115],
        "Cn8": [142960.90702947846, 2009.9773242630476],
        "Cn9": [144970.8843537415, 2009.9773242630476],
        "D#1": [146980.86167800456, 2009.9773242630476],
        "D#2": [148990.8390022676, 2009.9773242630476],
        "D#3": [151000.81632653065, 2009.9773242630476],
        "D#4": [153010.7936507937, 2021.5873015872887],
        "D#5": [155032.38095238098, 2012.879818594115],
        "D#6": [157045.2607709751, 2015.7823129251824],
        "D#7": [159061.04308390027, 2009.9773242630476],
        "D#8": [161071.0204081633, 2009.9773242630476],
        "Db1": [163080.99773242636, 2009.9773242630476],
        "Db2": [165090.9750566894, 2009.9773242630476],
        "Db3": [167100.95238095245, 2009.9773242630476],
        "Db4": [169110.9297052155, 2024.489795918356],
        "Db5": [171135.41950113387, 2012.879818594115],
        "Db6": [173148.299319728, 2012.879818594115],
        "Db7": [175161.1791383221, 2012.879818594115],
        "Db8": [177174.0589569162, 2009.9773242630476],
        "Dn1": [179184.03628117926, 2009.9773242630476],
        "Dn2": [181194.0136054423, 2009.9773242630476],
        "Dn3": [183203.99092970535, 2009.9773242630476],
        "Dn4": [185213.9682539684, 2024.489795918356],
        "Dn5": [187238.45804988677, 2015.7823129251824],
        "Dn6": [189254.24036281195, 2012.879818594115],
        "Dn7": [191267.12018140606, 2012.879818594115],
        "Dn8": [193280.00000000017, 2009.9773242630476],
        "E#1": [195289.97732426322, 2009.9773242630476],
        "E#2": [197299.95464852627, 2009.9773242630476],
        "E#3": [199309.93197278932, 2009.9773242630476],
        "E#4": [201319.90929705236, 2009.9773242630476],
        "E#5": [203329.8866213154, 2015.7823129251824],
        "E#6": [205345.6689342406, 2015.7823129251824],
        "E#7": [207361.45124716577, 2009.9773242630476],
        "E#8": [209371.4285714288, 2007.0748299319803],
        "Eb1": [211378.5034013608, 2009.9773242630476],
        "Eb2": [213388.48072562384, 2009.9773242630476],
        "Eb3": [215398.4580498869, 2009.9773242630476],
        "Eb4": [217408.43537414994, 2021.5873015872887],
        "Eb5": [219430.02267573724, 2012.879818594115],
        "Eb6": [221442.90249433136, 2015.7823129251824],
        "Eb7": [223458.68480725653, 2009.9773242630476],
        "Eb8": [225468.66213151958, 2009.9773242630476],
        "En1": [227478.63945578263, 2009.9773242630476],
        "En2": [229488.61678004568, 2009.9773242630476],
        "En3": [231498.59410430872, 2009.9773242630476],
        "En4": [233508.57142857177, 2009.9773242630476],
        "En5": [235518.54875283482, 2015.7823129251824],
        "En6": [237534.33106576, 2015.7823129251824],
        "En7": [239550.11337868517, 2009.9773242630476],
        "En8": [241560.09070294822, 2007.0748299319803],
        "F#1": [243567.1655328802, 2009.9773242630476],
        "F#2": [245577.14285714325, 2009.9773242630476],
        "F#3": [247587.1201814063, 2009.9773242630476],
        "F#4": [249597.09750566934, 2009.9773242630476],
        "F#5": [251607.0748299324, 2015.7823129251824],
        "F#6": [253622.8571428576, 2015.7823129251824],
        "F#7": [255638.63945578277, 2009.9773242630476],
        "F#8": [257648.61678004582, 2007.0748299319803],
        "Fb1": [259655.6916099778, 2009.9773242630476],
        "Fb2": [261665.66893424085, 2009.9773242630476],
        "Fb3": [263675.6462585039, 2009.9773242630476],
        "Fb4": [265685.6235827669, 2009.9773242630476],
        "Fb5": [267695.60090703, 2015.7823129251824],
        "Fb6": [269711.38321995514, 2015.7823129251824],
        "Fb7": [271727.16553288035, 2009.9773242630476],
        "Fb8": [273737.1428571434, 2007.0748299319803],
        "Fn1": [275744.2176870754, 2009.9773242630476],
        "Fn2": [277754.19501133845, 2009.9773242630476],
        "Fn3": [279764.17233560147, 2009.9773242630476],
        "Fn4": [281774.14965986455, 2009.9773242630476],
        "Fn5": [283784.12698412756, 2015.7823129251824],
        "Fn6": [285799.90929705277, 2015.7823129251824],
        "Fn7": [287815.6916099779, 2009.9773242630476],
        "Fn8": [289825.668934241, 2007.0748299319803],
        "G#1": [291832.74376417295, 2009.9773242630476],
        "G#2": [293842.721088436, 2024.4897959183845],
        "G#3": [295867.21088435437, 2009.9773242630476],
        "G#4": [297877.18820861744, 2009.9773242630476],
        "G#5": [299887.16553288046, 2012.879818594115],
        "G#6": [301900.0453514746, 2012.879818594115],
        "G#7": [303912.92517006875, 2009.9773242630476],
        "G#8": [305922.90249433176, 2007.0748299319803],
        "Gb1": [307929.9773242638, 2009.9773242630476],
        "Gb2": [309939.9546485268, 2009.9773242630476],
        "Gb3": [311949.93197278987, 2009.9773242630476],
        "Gb4": [313959.9092970529, 2009.9773242630476],
        "Gb5": [315969.88662131596, 2015.7823129251824],
        "Gb6": [317985.6689342411, 2015.7823129251824],
        "Gb7": [320001.4512471663, 2009.9773242630476],
        "Gb8": [322011.42857142934, 2007.0748299319803],
        "Gn1": [324018.50340136135, 2009.9773242630476],
        "Gn2": [326028.48072562437, 2009.9773242630476],
        "Gn3": [328038.45804988744, 2009.9773242630476],
        "Gn4": [330048.43537415046, 2009.9773242630476],
        "Gn5": [332058.41269841354, 2015.7823129251824],
        "Gn6": [334074.1950113387, 2015.7823129251824],
        "Gn7": [336089.9773242639, 2009.9773242630476],
        "Gn8": [338099.9546485269, 2007.0748299319803]
    }
});

window.violin = new Howl({
    src: ['violin.mp3'],
    volume: 1,
    sprite: {
        "A#1": [0, 2500.453514739229],
        "A#2": [2500.453514739229, 2500.453514739229],
        "A#3": [5000.907029478458, 2500.4535147392285],
        "A#4": [7501.360544217686, 2500.4535147392294],
        "A#5": [10001.814058956916, 2500.4535147392294],
        "A#6": [12502.267573696145, 2500.4535147392294],
        "A#7": [15002.721088435374, 2500.4535147392294],
        "A#8": [17503.174603174604, 2500.4535147392276],
        "Ab1": [20003.62811791383, 2500.4535147392276],
        "Ab2": [22504.08163265306, 2500.4535147392276],
        "Ab3": [25004.535147392286, 2500.4535147392276],
        "Ab4": [27504.988662131513, 2500.4535147392276],
        "Ab5": [30005.44217687074, 2500.453514739231],
        "Ab6": [32505.89569160997, 2500.4535147392276],
        "Ab7": [35006.3492063492, 2500.4535147392276],
        "Ab8": [37506.802721088425, 2750.4535147392276],
        "An1": [40257.256235827655, 2500.4535147392276],
        "An2": [42757.70975056688, 2500.4535147392276],
        "An3": [45258.16326530611, 2500.4535147392276],
        "An4": [47758.61678004533, 2500.4535147392276],
        "An5": [50259.070294784564, 2500.4535147392276],
        "An6": [52759.523809523795, 2500.4535147392276],
        "An7": [55259.97732426302, 2500.4535147392276],
        "An8": [57760.43083900225, 2500.4535147392276],
        "B#1": [60260.88435374147, 2500.4535147392276],
        "B#2": [62761.3378684807, 2500.4535147392276],
        "B#3": [65261.79138321993, 2500.4535147392344],
        "B#4": [67762.24489795916, 2500.4535147392344],
        "B#5": [70262.6984126984, 2500.4535147392344],
        "B#6": [72763.15192743763, 2500.4535147392344],
        "B#7": [75263.60544217686, 2500.4535147392344],
        "B#8": [77764.05895691611, 2500.4535147392344],
        "Bb1": [80264.51247165534, 2500.4535147392344],
        "Bb2": [82764.96598639457, 2500.4535147392344],
        "Bb3": [85265.4195011338, 2500.4535147392344],
        "Bb4": [87765.87301587305, 2500.4535147392344],
        "Bb5": [90266.32653061228, 2500.4535147392344],
        "Bb6": [92766.78004535151, 2500.4535147392344],
        "Bb7": [95267.23356009074, 2500.4535147392344],
        "Bb8": [97767.68707482998, 2500.4535147392344],
        "Bn1": [100268.14058956922, 2750.4535147392344],
        "Bn2": [103018.59410430845, 2500.4535147392344],
        "Bn3": [105519.04761904768, 2500.4535147392344],
        "Bn4": [108019.50113378692, 2500.4535147392344],
        "Bn5": [110519.95464852615, 2500.4535147392344],
        "Bn6": [113020.40816326538, 2500.4535147392344],
        "Bn7": [115520.86167800461, 2500.4535147392344],
        "Bn8": [118021.31519274386, 2500.4535147392344],
        "C#1": [120521.76870748309, 2500.4535147392344],
        "C#2": [123022.22222222232, 2500.4535147392344],
        "C#3": [125522.67573696157, 2500.4535147392344],
        "C#4": [128023.1292517008, 2500.4535147392344],
        "C#5": [130523.58276644003, 2500.4535147392344],
        "C#6": [133024.03628117926, 2500.4535147392344],
        "C#7": [135524.4897959185, 2500.4535147392344],
        "C#8": [138024.94331065772, 2500.4535147392344],
        "Cb1": [140525.39682539698, 2500.4535147392344],
        "Cb2": [143025.8503401362, 2500.4535147392344],
        "Cb3": [145526.30385487544, 2500.4535147392344],
        "Cb4": [148026.75736961467, 2500.4535147392344],
        "Cb5": [150527.2108843539, 2500.4535147392344],
        "Cb6": [153027.66439909313, 2500.4535147392344],
        "Cb7": [155528.11791383236, 2500.4535147392344],
        "Cb8": [158028.57142857162, 2500.4535147392344],
        "Cb9": [160529.02494331085, 2500.4535147392344],
        "Cn1": [163029.4784580501, 2500.4535147392344],
        "Cn2": [165529.93197278932, 2500.4535147392344],
        "Cn3": [168030.38548752855, 2500.4535147392344],
        "Cn4": [170530.83900226778, 2500.4535147392344],
        "Cn5": [173031.292517007, 2500.4535147392344],
        "Cn6": [175531.74603174624, 2500.4535147392344],
        "Cn7": [178032.1995464855, 2500.4535147392344],
        "Cn8": [180532.65306122473, 2500.4535147392344],
        "Cn9": [183033.10657596396, 2500.4535147392344],
        "D#1": [185533.5600907032, 2500.4535147392344],
        "D#2": [188034.01360544242, 2500.4535147392344],
        "D#3": [190534.46712018165, 2500.4535147392344],
        "D#4": [193034.92063492088, 2500.4535147392344],
        "D#5": [195535.3741496601, 2500.4535147392344],
        "D#6": [198035.82766439937, 2500.4535147392344],
        "D#7": [200536.2811791386, 2500.4535147392344],
        "D#8": [203036.73469387784, 2500.4535147392344],
        "Db1": [205537.18820861707, 2500.4535147392344],
        "Db2": [208037.6417233563, 2500.4535147392344],
        "Db3": [210538.09523809553, 2500.4535147392344],
        "Db4": [213038.54875283476, 2500.4535147392344],
        "Db5": [215539.00226757402, 2500.4535147392344],
        "Db6": [218039.45578231325, 2500.4535147392344],
        "Db7": [220539.90929705248, 2500.4535147392344],
        "Db8": [223040.3628117917, 2500.4535147392344],
        "Dn1": [225540.81632653094, 2500.4535147392344],
        "Dn2": [228041.26984127017, 2500.4535147392344],
        "Dn3": [230541.7233560094, 2500.4535147392344],
        "Dn4": [233042.17687074863, 2500.4535147392344],
        "Dn5": [235542.6303854879, 2500.4535147392344],
        "Dn6": [238043.08390022712, 2500.4535147392344],
        "Dn7": [240543.53741496635, 2500.4535147392344],
        "Dn8": [243043.9909297056, 2500.4535147392344],
        "E#1": [245544.44444444482, 2500.4535147392344],
        "E#2": [248044.89795918405, 2500.4535147392344],
        "E#3": [250545.35147392328, 2500.4535147392344],
        "E#4": [253045.80498866254, 2500.4535147392344],
        "E#5": [255546.25850340177, 2500.453514739206],
        "E#6": [258046.71201814097, 2500.453514739206],
        "E#7": [260547.16553288017, 2500.453514739206],
        "E#8": [263047.6190476194, 2500.453514739206],
        "Eb1": [265548.0725623586, 2500.453514739206],
        "Eb2": [268048.5260770978, 2500.453514739206],
        "Eb3": [270548.979591837, 2500.453514739206],
        "Eb4": [273049.4331065762, 2500.453514739206],
        "Eb5": [275549.8866213154, 2500.453514739206],
        "Eb6": [278050.3401360546, 2500.453514739206],
        "Eb7": [280550.79365079384, 2500.453514739206],
        "Eb8": [283051.247165533, 2500.453514739206],
        "En1": [285551.70068027225, 2500.453514739206],
        "En2": [288052.1541950114, 2500.453514739206],
        "En3": [290552.60770975065, 2500.453514739206],
        "En4": [293053.0612244899, 2500.453514739206],
        "En5": [295553.51473922905, 2500.453514739206],
        "En6": [298053.9682539683, 2500.453514739206],
        "En7": [300554.42176870746, 2500.453514739206],
        "En8": [303054.8752834467, 2500.453514739206],
        "F#1": [305555.32879818586, 2500.453514739206],
        "F#2": [308055.7823129251, 2500.453514739206],
        "F#3": [310556.2358276643, 2500.453514739206],
        "F#4": [313056.6893424035, 2500.453514739206],
        "F#5": [315557.1428571427, 2500.453514739206],
        "F#6": [318057.5963718819, 2500.453514739206],
        "F#7": [320558.0498866211, 2500.453514739206],
        "F#8": [323058.5034013603, 2500.453514739206],
        "Fb1": [325558.95691609953, 2500.453514739206],
        "Fb2": [328059.41043083876, 2500.453514739206],
        "Fb3": [330559.86394557793, 2500.453514739206],
        "Fb4": [333060.31746031716, 2500.453514739206],
        "Fb5": [335560.77097505634, 2500.453514739206],
        "Fb6": [338061.22448979557, 2500.453514739206],
        "Fb7": [340561.6780045348, 2500.453514739206],
        "Fb8": [343062.131519274, 2500.453514739206],
        "Fn1": [345562.5850340132, 2500.453514739206],
        "Fn2": [348063.0385487524, 2500.453514739206],
        "Fn3": [350563.4920634916, 2500.453514739206],
        "Fn4": [353063.9455782308, 2500.453514739206],
        "Fn5": [355564.39909297, 2500.453514739206],
        "Fn6": [358064.85260770924, 2500.453514739206],
        "Fn7": [360565.3061224484, 2500.453514739206],
        "Fn8": [363065.75963718764, 2500.453514739206],
        "G#1": [365566.2131519268, 2500.453514739206],
        "G#2": [368066.66666666605, 2500.453514739206],
        "G#3": [370567.1201814052, 2500.453514739206],
        "G#4": [373067.57369614445, 2500.453514739206],
        "G#5": [375568.0272108837, 2500.453514739206],
        "G#6": [378068.48072562285, 2500.453514739206],
        "G#7": [380568.9342403621, 2500.453514739206],
        "G#8": [383069.38775510126, 2500.453514739206],
        "Gb1": [385569.8412698405, 2500.453514739206],
        "Gb2": [388070.29478457966, 2500.453514739206],
        "Gb3": [390570.7482993189, 2500.453514739206],
        "Gb4": [393071.2018140581, 2500.453514739206],
        "Gb5": [395571.6553287973, 2500.453514739206],
        "Gb6": [398072.1088435365, 2500.453514739206],
        "Gb7": [400572.5623582757, 2500.453514739206],
        "Gb8": [403073.0158730149, 2500.453514739206],
        "Gn1": [405573.46938775416, 2500.453514739206],
        "Gn2": [408073.92290249333, 2500.453514739206],
        "Gn3": [410574.37641723256, 2500.453514739206],
        "Gn4": [413074.82993197173, 2500.453514739206],
        "Gn5": [415575.28344671096, 2500.453514739206],
        "Gn6": [418075.73696145014, 2500.453514739206],
        "Gn7": [420576.19047618937, 2500.453514739206],
        "Gn8": [423076.6439909286, 2500.453514739206]
    }
});


function parsePianoCode(text, tempo) {
    var cur_oct = [];
    var cur_acc = [];

    for (var i = 0; i < 7; i++) {
        cur_oct[i] = 3;
        cur_acc[i] = 'n';
    }

    text = text.toUpperCase();
    var parsed = [];
    var lines = text.split(/\r?\n/);
    var bpmRE = /BPM: ([\d]+)/.exec(lines.shift());

    if (bpmRE[1] && isFinite(bpmRE[1])) {
        tempo = 60 / bpmRE[1];
    } //lines.shift() // first item aka bpm


    lines.forEach(function (l) {
        var chords = l.split(',');
        chords.forEach(function (ch) {
            var s = ch.split('/');
            var notes = s[0].split('-');
            var notesToPlay = [];
            notes.forEach(function (n) {
                if (!n.length) {
                    return;
                }

                var note = n.charCodeAt(0) - 64 - 1;

                if (note < 0 || note > 6) {
                    return;
                }

                for (var _i = 1; _i < n.length; _i++) {
                    var _char = n.charAt(_i);

                    var charCode = n.charCodeAt(_i) - 48;

                    if (_char == '#' || _char == 'b' || _char == 'n') {
                        cur_acc[note] = _char;
                    } else if (_char == 's') {
                        cur_acc[note] = '#';
                    } else if (charCode >= 0 && charCode < 10) {
                        cur_oct[note] = charCode;
                    }
                }

                notesToPlay.push("".concat(n.charAt(0)).concat(cur_acc[note]).concat(cur_oct[note]));
            });
            var lt = tempo;

            if (s.length >= 2 && isFinite(s[1])) {
                lt /= s[1];
            }

            parsed.push({
                n: notesToPlay,
                t: lt
            });
        });
    });
    return parsed;
}

